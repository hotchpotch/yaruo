<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Making a change - やる夫で学ぶ gitcore-tutorial</title><link href="/yaruo/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" /><script charset="utf-8" src="http://font.textar.tv/webfont.js"></script></head><body><h1>やる夫で学ぶ gitcore-tutorial</h1><div id="content"><h2>Making a change</h2><pre><code class="aa">　　　　　　　　　　　／.:.:.　　　　　　　　 ＼
　 　 　 　 　 　 　 /:,:.:.:　 ／　　　ヽ　　　　＼
　　　　　　　　　 /.:.l:.:.:/:/　　　:/ 　&#39;,　:l　　 ヾ`ｰ
　 　 　 　 　 　 /!:.:.|:.: l/　 〃 /　j　}　:|　 　 ﾊ
　　　　　　　　/ｲ:.:.i|:.:.jL∠/_/ | /l.ﾑ_/|　l 　ｌ }
　　　　　　　　　N:.ﾊ:.:.:lｨfｱﾄ/　ﾚ　ｨ=ﾄ | /| ∧j　　…思い出して
　　　　　　　　　　ヽﾑ:.} ii;_j　　　　ii;ﾘ ﾙ iﾚヽ.　　　 インデックスに入っていた hello ファイルと
　 　 　 　 　 　 　 　 `ﾍ:ゝ　　　_ 　 　 小/　　　　 　その後変更した hello ファイルは別物だった
　 　 　 　 　 　 　 　 　 ヾ:{＞､ _　ｨ＜}/|/　　　　　　　
　　　　　　　　　　 _, ｨr&#39;´ヽ｛ __＿`}　ヽ､_
　　　　　　　　　／| l:|　　　| =＝=|　　 |:lﾞヽ
　　　　　 　 　 /　 | l:ｌ　　　l 　 　 l　　 l::ｌ　l
　　 　 　 　 　 l　　ヽﾊ　 　 l　 　 l　　//　 |


　 　 　　　＿＿＿_
　 　　　／⌒　　⌒＼ ﾎｼﾞﾎｼﾞ
　　　／（ ●） 　（●）＼
　 ／::::::⌒（__人__）⌒::::: ＼ 　確かに git-diff-files -p の結果は
　 |　　　 ｍj |ー&#39;´　　　　　 |　　インデックスに追加したファイルとワーキングツリーとの差分だったお
　 ＼　 〈＿_ﾉ　　　　　 　／
　　　　ノ　　ﾉ


　　　　　　　　　　　／.:.:.　　　　　　　　 ＼
　 　 　 　 　 　 　 /:,:.:.:　 ／　　　ヽ　　　　＼
　　　　　　　　　 /.:.l:.:.:/:/　　　:/ 　&#39;,　:l　　 ヾ`ｰ
　 　 　 　 　 　 /!:.:.|:.: l/　 〃 /　j　}　:|　 　 ﾊ
　　　　　　　　/ｲ:.:.i|:.:.jL∠/_/ | /l.ﾑ_/|　l 　ｌ }
　　　　　　　　　N:.ﾊ:.:.:lｨfｱﾄ/　ﾚ　ｨ=ﾄ | /| ∧j　　
　　　　　　　　　　ヽﾑ:.} ii;_j　　　　ii;ﾘ ﾙ iﾚヽ.　　git-write-tree で作成される tree の内容も
　 　 　 　 　 　 　 　 `ﾍ:ゝ　　　_ 　 　 小/　　　　 インデックスの中身と一緒
　 　 　 　 　 　 　 　 　 ヾ:{＞､ _　ｨ＜}/|/　　　　git-diff-index で tree とインデックス、
　　　　　　　　　　 _, ｨr&#39;´ヽ｛ __＿`}　ヽ､_　　　　　　もしくは tree とワーキングツリーとの差分を見ることができる
　　　　　　　　　／| l:|　　　| =＝=|　　 |:lﾞヽ　　　デフォルトでは tree とワーキングツリーとの差分
　　　　　 　 　 /　 | l:ｌ　　　l 　 　 l　　 l::ｌ　l
　　 　 　 　 　 l　　ヽﾊ　 　 l　 　 l　　//　 |
</code></pre>

<pre><code>$ git diff-index -p HEAD
diff --git a/hello b/hello
index 557db03..263414f 100644
--- a/hello
+++ b/hello
@@ -1 +1,2 @@
 Hello World
+It&#39;s a new day for git
</code></pre>

<pre><code class="aa">　 　 　　　＿＿＿_
　 　　　／⌒　　⌒＼
　　　／（ ●） 　（●）＼
　 ／::::::⌒（__人__）⌒::::: ＼　　さっきの git diff-file -p と同じ diff が出力されたお！
　 |　　　　　|r┬-|　　　　　|　
　 ＼ 　　 　 `ー&#39;´ 　 　 ／


　　 　 ,　&#39;´￣￣｀ ｰ-､　　　　　
　　 ／　　 〃&quot; ｀ヽ､　＼　　　　
　 /　/　 ﾊ/　　　　 ＼ﾊﾍ　　　
　 |i │ ｌ |ﾘノ　　　 ｀ヽ}_}ハ.　　HEAD っていうのは master の最後のコミットを指すんだったねっ
　 |i　|　从 ● 　 　 ●ｌ小N　　　だからこれはさっきのコミットツリーとワーキングツリーとの diff なんだよっ
　 |i （|　⊂⊃ ､_,､_,　⊂lｉ|ノ　　 
　 | i⌒ヽ j　　（_.ノ 　　ﾉi|__／⌒)　
　 | ヽ 　ヽx＞､ __,　イｌ　|::::ヽ／.
　 |　∧__,ﾍ}::ﾍ三|:::::/ｌ|　|&#39;,:::::ﾊ　　
　 |　ヾ_:::ッﾘ :::∨:／　|　| &gt;&#39;&#39;&#39;´


　　　　　　　　　　　／.:.:.　　　　　　　　 ＼
　 　 　 　 　 　 　 /:,:.:.:　 ／　　　ヽ　　　　＼
　　　　　　　　　 /.:.l:.:.:/:/　　　:/ 　&#39;,　:l　　 ヾ`ｰ
　 　 　 　 　 　 /!:.:.|:.: l/　 〃 /　j　}　:|　 　 ﾊ
　　　　　　　　/ｲ:.:.i|:.:.jL∠/_/ | /l.ﾑ_/|　l 　ｌ }
　　　　　　　　　N:.ﾊ:.:.:lｨfｱﾄ/　ﾚ　ｨ=ﾄ | /| ∧j　
　　　　　　　　　　ヽﾑ:.} ii;_j　　　　ii;ﾘ ﾙ iﾚヽ.　　git diff HEAD で git diff-index -p HEAD と同じことができる
　 　 　 　 　 　 　 　 `ﾍ:ゝ　　　_ 　 　 小/　　　　 
　 　 　 　 　 　 　 　 　 ヾ:{＞､ _　ｨ＜}/|/　　　　
　　　　　　　　　　 _, ｨr&#39;´ヽ｛ __＿`}　ヽ､_　　　　　　
　　　　　　　　　／| l:|　　　| =＝=|　　 |:lﾞヽ　　　
　　　　　 　 　 /　 | l:ｌ　　　l 　 　 l　　 l::ｌ　l
　　 　 　 　 　 l　　ヽﾊ　 　 l　 　 l　　//　 |


　 　 　　　＿＿＿_
　 　　　／⌒　　⌒＼
　　　／（ ●） 　（●）＼　　　コマンドの小出しにはもう慣れたお！
　 ／::::::⌒（__人__）⌒::::: ＼　　
　 |　　　　　|r┬-|　　　　　|　　
　 ＼ 　　 　 `ー&#39;´ 　 　 ／



　　　　　　　　　　　／.:.:.　　　　　　　　 ＼
　 　 　 　 　 　 　 /:,:.:.:　 ／　　　ヽ　　　　＼
　　　　　　　　　 /.:.l:.:.:/:/　　　:/ 　&#39;,　:l　　 ヾ`ｰ
　 　 　 　 　 　 /!:.:.|:.: l/　 〃 /　j　}　:|　 　 ﾊ
　　　　　　　　/ｲ:.:.i|:.:.jL∠/_/ | /l.ﾑ_/|　l 　ｌ }
　　　　　　　　　N:.ﾊ:.:.:lｨfｱﾄ/　ﾚ　ｨ=ﾄ | /| ∧j　今のは tree とワーキングツリーとの差分だった
　　　　　　　　　　ヽﾑ:.} ii;_j　　　　ii;ﾘ ﾙ iﾚヽ.　　git diff-index に --cached オプションを渡すことで
　 　 　 　 　 　 　 　 `ﾍ:ゝ　　　_ 　 　 小/　　　　tree とインデックスの差分を見ることができる
　 　 　 　 　 　 　 　 　 ヾ:{＞､ _　ｨ＜}/|/　　　　
　　　　　　　　　　 _, ｨr&#39;´ヽ｛ __＿`}　ヽ､_　　　　　　
　　　　　　　　　／| l:|　　　| =＝=|　　 |:lﾞヽ　　　
　　　　　 　 　 /　 | l:ｌ　　　l 　 　 l　　 l::ｌ　l
　　 　 　 　 　 l　　ヽﾊ　 　 l　 　 l　　//　 |
</code></pre>

<pre><code>$ git diff-index --cached -p HEAD
</code></pre>

<pre><code class="aa">　　 　　 　＿＿＿_
　　　　 ／ ＼　　／＼　ｷﾘｯ
.　　　／　（ー） 　（ー）＼　　何の差分も出力されないのは
　　／　　 ⌒（__人__）⌒ ＼　　今のインデックスはさっきコミットしたばかりだからだお！
　　|　　 　　　|r┬-|　　　　|　　
　　 ＼　　　　 `ー&#39;´　　 ／　　
　　ノ　　　　　　　　　　 　＼

　　 　 ,　&#39;´￣￣｀ ｰ-､　　　　　
　　 ／　　 〃&quot; ｀ヽ､　＼　　　　
　 /　/　 ﾊ/　　　　 ＼ﾊﾍ　　　
　 |i │ ｌ |ﾘノ　　　 ｀ヽ}_}ハ.　　ちなみに git-diff-index はインデックスに入ってるファイルのみ比較するにょろ
　 |i　|　从 ● 　 　 ●ｌ小N　　　適当にファイルを作ってもインデックスに入ってなければその diff は表示されないよっ
　 |i （|　⊂⊃ ､_,､_,　⊂lｉ|ノ　　 
　 | i⌒ヽ j　　（_.ノ 　　ﾉi|__／⌒)　
　 | ヽ 　ヽx＞､ __,　イｌ　|::::ヽ／.
　 |　∧__,ﾍ}::ﾍ三|:::::/ｌ|　|&#39;,:::::ﾊ　　
　 |　ヾ_:::ッﾘ :::∨:／　|　| &gt;&#39;&#39;&#39;´


　　　　　　　　　　　／.:.:.　　　　　　　　 ＼
　 　 　 　 　 　 　 /:,:.:.:　 ／　　　ヽ　　　　＼
　　　　　　　　　 /.:.l:.:.:/:/　　　:/ 　&#39;,　:l　　 ヾ`ｰ
　 　 　 　 　 　 /!:.:.|:.: l/　 〃 /　j　}　:|　 　 ﾊ
　　　　　　　　/ｲ:.:.i|:.:.jL∠/_/ | /l.ﾑ_/|　l 　ｌ }
　　　　　　　　　N:.ﾊ:.:.:lｨfｱﾄ/　ﾚ　ｨ=ﾄ | /| ∧j　　…これからファイルへの変更をコミットする
　　　　　　　　　　ヽﾑ:.} ii;_j　　　　ii;ﾘ ﾙ iﾚヽ.　　　「ワーキングツリー」「インデックス」「コミットされたツリー」
　 　 　 　 　 　 　 　 `ﾍ:ゝ　　　_ 　 　 小/　　　　　この三つの違いを意識しておいて
　 　 　 　 　 　 　 　 　 ヾ:{＞､ _　ｨ＜}/|/　　　　
　　　　　　　　　　 _, ｨr&#39;´ヽ｛ __＿`}　ヽ､_　　　　　まずはインデックスを更新する　　
　　　　　　　　　／| l:|　　　| =＝=|　　 |:lﾞヽ　　　
　　　　　 　 　 /　 | l:ｌ　　　l 　 　 l　　 l::ｌ　l
　　 　 　 　 　 l　　ヽﾊ　 　 l　 　 l　　//　 |
</code></pre>

<pre><code>git update-index hello
</code></pre>

<pre><code class="aa">　　 　 ,　&#39;´￣￣｀ ｰ-､　　　　　
　　 ／　　 〃&quot; ｀ヽ､　＼　　　　
　 /　/　 ﾊ/　　　　 ＼ﾊﾍ　　　
　 |i │ ｌ |ﾘノ　　　 ｀ヽ}_}ハ.　　もうインデックスに追加されてるから --add はいらないよっ
　 |i　|　从 ● 　 　 ●ｌ小N　　
　 |i （|　⊂⊃ ､_,､_,　⊂lｉ|ノ　　 
　 | i⌒ヽ j　　（_.ノ 　　ﾉi|__／⌒)　
　 | ヽ 　ヽx＞､ __,　イｌ　|::::ヽ／.
　 |　∧__,ﾍ}::ﾍ三|:::::/ｌ|　|&#39;,:::::ﾊ　　
　 |　ヾ_:::ッﾘ :::∨:／　|　| &gt;&#39;&#39;&#39;´



　　　　　　　　　　　／.:.:.　　　　　　　　 ＼
　 　 　 　 　 　 　 /:,:.:.:　 ／　　　ヽ　　　　＼
　　　　　　　　　 /.:.l:.:.:/:/　　　:/ 　&#39;,　:l　　 ヾ`ｰ
　 　 　 　 　 　 /!:.:.|:.: l/　 〃 /　j　}　:|　 　 ﾊ
　　　　　　　　/ｲ:.:.i|:.:.jL∠/_/ | /l.ﾑ_/|　l 　ｌ }
　　　　　　　　　N:.ﾊ:.:.:lｨfｱﾄ/　ﾚ　ｨ=ﾄ | /| ∧j　　ここで git-diff-* を試してみて
　　　　　　　　　　ヽﾑ:.} ii;_j　　　　ii;ﾘ ﾙ iﾚヽ.　　　
　 　 　 　 　 　 　 　 `ﾍ:ゝ　　　_ 　 　 小/　　　　　
　 　 　 　 　 　 　 　 　 ヾ:{＞､ _　ｨ＜}/|/　　　　
　　　　　　　　　　 _, ｨr&#39;´ヽ｛ __＿`}　ヽ､_　　　
　　　　　　　　　／| l:|　　　| =＝=|　　 |:lﾞヽ　　　
　　　　　 　 　 /　 | l:ｌ　　　l 　 　 l　　 l::ｌ　l
　　 　 　 　 　 l　　ヽﾊ　 　 l　 　 l　　//　 |
</code></pre>

<pre><code>$ git diff-files -p
$ git diff-index -p HEAD
diff --git a/hello b/hello
index 557db03..263414f 100644
--- a/hello
+++ b/hello
@@ -1 +1,2 @@
 Hello World
+It&#39;s a new day for git
$ git diff-index --cached -p HEAD
diff --git a/hello b/hello
index 557db03..263414f 100644
--- a/hello
+++ b/hello
@@ -1 +1,2 @@
 Hello World
+It&#39;s a new day for git

</code></pre>

<pre><code class="aa">　 　 　　　＿＿＿_
　 　　　／⌒　　⌒＼
　　　／（ ●） 　（●）＼　　インデックスとワーキングツリーの内容が一緒だから
　 ／::::::⌒（__人__）⌒::::: ＼　git-diff-files は何も出力しなくなったんだお！
　 |　　　　　|r┬-|　　　　　|　
　 ＼ 　　 　 `ー&#39;´ 　 　 ／



　　　　　　　　　　　／.:.:.　　　　　　　　 ＼
　 　 　 　 　 　 　 /:,:.:.:　 ／　　　ヽ　　　　＼
　　　　　　　　　 /.:.l:.:.:/:/　　　:/ 　&#39;,　:l　　 ヾ`ｰ
　 　 　 　 　 　 /!:.:.|:.: l/　 〃 /　j　}　:|　 　 ﾊ
　　　　　　　　/ｲ:.:.i|:.:.jL∠/_/ | /l.ﾑ_/|　l 　ｌ }
　　　　　　　　　N:.ﾊ:.:.:lｨfｱﾄ/　ﾚ　ｨ=ﾄ | /| ∧j　　そう…インデックスを更新したから次はコミット
　　　　　　　　　　ヽﾑ:.} ii;_j　　　　ii;ﾘ ﾙ iﾚヽ.　　　
　 　 　 　 　 　 　 　 `ﾍ:ゝ　　　_ 　 　 小/　　　　　
　 　 　 　 　 　 　 　 　 ヾ:{＞､ _　ｨ＜}/|/　　　　
　　　　　　　　　　 _, ｨr&#39;´ヽ｛ __＿`}　ヽ､_　　　
　　　　　　　　　／| l:|　　　| =＝=|　　 |:lﾞヽ　　　
　　　　　 　 　 /　 | l:ｌ　　　l 　 　 l　　 l::ｌ　l
　　 　 　 　 　 l　　ヽﾊ　 　 l　 　 l　　//　 |


　 　 　　　＿＿＿_
　 　　　／⌒　　⌒＼
　　　／（ ＞） 　（＜）＼　　git-write-tree なんて使ってらんないお！
　 ／::::::⌒（__人__）⌒::::: ＼ 　さっき言ってた git-commit を使ってみるお！
　 |　　　　/| | | | |　　　　　|　 目標をインデックスに入れてコミットだお！
　 ＼　 (、`ー―&#39;´,　　 　／
　　　　　 ￣￣￣ 　

　　 　 ,　&#39;´￣￣｀ ｰ-､　　　　　
　　 ／　　 〃&quot; ｀ヽ､　＼　　　　
　 /　/　 ﾊ/　　　　 ＼ﾊﾍ　　　
　 |i │ ｌ |ﾘノ　　　 ｀ヽ}_}ハ.　　git-commit は自動的に HEAD を親コミットとしてコミットしてくれるのさっ
　 |i　|　从 ● 　 　 ●ｌ小N　　
　 |i （|　⊂⊃ ､_,､_,　⊂lｉ|ノ　　 
　 | i⌒ヽ j　　（_.ノ 　　ﾉi|__／⌒)　
　 | ヽ 　ヽx＞､ __,　イｌ　|::::ヽ／.
　 |　∧__,ﾍ}::ﾍ三|:::::/ｌ|　|&#39;,:::::ﾊ　　
　 |　ヾ_:::ッﾘ :::∨:／　|　| &gt;&#39;&#39;&#39;´
</code></pre>

<pre><code>$ git commit

# Please enter the commit message for your changes.
# (Comment lines starting with &#39;#&#39; will not be included)
# On branch master
# Changes to be committed:
#   (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)
#
#&gt;      modified:   hello
#
</code></pre>

<pre><code class="aa">　 　 　　　＿＿＿_
　 　　　／ノ 　 ヽ､_＼　　
　　　／（ ○）}liil{（○）＼　　vi が起動したお！保存も終了もできないお！！
　 ／　　　 （__人__）　　　＼　
　 |　　　ヽ　|!!il|!|!l|　/　　　|
　 ＼　　　　|ｪｪｪｪ| 　 　 ／


　　　　　　　　　　 　 -‐ &#39;´￣￣｀ヽ､
　　 　 　 　 　 　 ／　／&quot; ｀ヽ ヽ　　＼
　　　　　　　　　//, &#39;/　　　　 ヽﾊ 　､　ヽ　幼稚園からやり直してこい！
　　　　　　　　 〃 {_{＼　　　 ／ﾘ| ｌ │ i|　i で挿入モード、コミットメッセージを書いて
　　　　　　　　 ﾚ!小ｌ●　　　 ● 从　|、i|　&lt;ESC&gt; で抜けたら ZZ で保存終了だよっ！
　　　　　　　 　 ヽ|l⊃　､_,､_,　⊂⊃　|ﾉ│
　 　 　 　 /⌒ヽ__|ﾍ　　 ゝ._）　 　j /⌒i !　ちなみに # で始まる行は削除されるから無視していいんだよっ！
　　　　　　＼ /:::::|　l＞,､ __,　イァ/　 /│
.　　　　　 　 /:::::/|　|　ヾ:::|三/::{ﾍ､__∧ |
　　　　　　　｀ヽ&lt; |　|　　ヾ∨:::/ヾ:::彡&#39;　|
</code></pre>

<pre><code>&quot;.git/COMMIT_EDITMSG&quot; 13L, 353C 書込み

Created commit bb83222: ⊂二二二（ ＾ω＾）二⊃
 1 files changed, 1 insertions(+), 0 deletions(-)
</code></pre>

<pre><code class="aa">　　　　　　　　　＿＿＿
　　　　　　　／ ⌒　　⌒＼
　　　　　 ／　（⌒）　 （⌒） ＼　　　
　　　　／ 　 ///（__人__）/// ＼　で、できた！
　　 　 |　　 u. 　 `Y⌒y&#39;´　　　 |　　やる夫にもコミットできたお！！
　 　 　 ＼ 　 　 　 ﾞー ′　　,／　　　
　　　 　 /⌒ヽ　 　ー‐ 　 　ｨヽ　　　　
　 　 　 / rｰ&#39;ゝ　　　　　　　〆ヽ
　　　　/,ﾉヾ　,&gt;　　　　　　ヾ_ノ,|
　　　　|　ヽ〆　　　　　　　　|´　|



　　　　　　　　　　　／.:.:.　　　　　　　　 ＼
　 　 　 　 　 　 　 /:,:.:.:　 ／　　　ヽ　　　　＼
　　　　　　　　　 /.:.l:.:.:/:/　　　:/ 　&#39;,　:l　　 ヾ`ｰ
　 　 　 　 　 　 /!:.:.|:.: l/　 〃 /　j　}　:|　 　 ﾊ
　　　　　　　　/ｲ:.:.i|:.:.jL∠/_/ | /l.ﾑ_/|　l 　ｌ }
　　　　　　　　　N:.ﾊ:.:.:lｨfｱﾄ/　ﾚ　ｨ=ﾄ | /| ∧j　　お疲れさま…
　　　　　　　　　　ヽﾑ:.} ii;_j　　　　ii;ﾘ ﾙ iﾚヽ.　　　「インデックスに追加してコミット」これが基本
　 　 　 　 　 　 　 　 `ﾍ:ゝ　　　_ 　 　 小/　　　　　覚えておいて
　 　 　 　 　 　 　 　 　 ヾ:{＞､ _　ｨ＜}/|/　　　　
　　　　　　　　　　 _, ｨr&#39;´ヽ｛ __＿`}　ヽ､_　　　
　　　　　　　　　／| l:|　　　| =＝=|　　 |:lﾞヽ　　　
　　　　　 　 　 /　 | l:ｌ　　　l 　 　 l　　 l::ｌ　l
　　 　 　 　 　 l　　ヽﾊ　 　 l　 　 l　　//　 |



　　 　 ,　&#39;´￣￣｀ ｰ-､　　　　　
　　 ／　　 〃&quot; ｀ヽ､　＼　　　　
　 /　/　 ﾊ/　　　　 ＼ﾊﾍ　　　
　 |i │ ｌ |ﾘノ　　　 ｀ヽ}_}ハ.　　次は過去のコミットを参照する方法だよ！
　 |i　|　从 ● 　 　 ●ｌ小N　　
　 |i （|　⊂⊃ ､_,､_,　⊂lｉ|ノ　　 
　 | i⌒ヽ j　　（_.ノ 　　ﾉi|__／⌒)　
　 | ヽ 　ヽx＞､ __,　イｌ　|::::ヽ／.
　 |　∧__,ﾍ}::ﾍ三|:::::/ｌ|　|&#39;,:::::ﾊ　　
　 |　ヾ_:::ッﾘ :::∨:／　|　| &gt;&#39;&#39;&#39;´
</code></pre>
</div><script>for (var aas = document.querySelectorAll('.aa'), i = 0, aa = aas[i]; aa = aas[i++]; ) aa.className = 'textar-aa'; </script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){   (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-34276254-3', 'motemen.github.io'); ga('send', 'pageview'); </script></body></html>